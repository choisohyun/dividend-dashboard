# 구글 시트 연동 가이드

## 개요

구글 시트의 데이터를 배당 대시보드로 직접 가져올 수 있습니다. 이를 위해 서비스 계정(Service Account) 설정이 필요합니다.

## 1. 서비스 계정 설정 (관리자)

이 단계는 대시보드 배포자가 한 번만 수행하면 됩니다.

1. [Google Cloud Console](https://console.cloud.google.com/) 접속
2. 새 프로젝트 생성 (예: `dividend-dashboard`)
3. **API 및 서비스** > **라이브러리** > **Google Sheets API** 검색 및 사용 설정
4. **API 및 서비스** > **사용자 인증 정보** > **사용자 인증 정보 만들기** > **서비스 계정**
5. 서비스 계정 이름 입력 후 생성
6. 생성된 서비스 계정 클릭 > **키** 탭 > **키 추가** > **새 키 만들기** > **JSON**
7. 다운로드된 JSON 파일 내용을 `.env.local`에 설정:

```env
GOOGLE_SERVICE_ACCOUNT_EMAIL=your-service-account@project-id.iam.gserviceaccount.com
GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n..."
```

## 2. 시트 공유 (사용자)

데이터를 가져오려는 구글 시트를 서비스 계정과 공유해야 합니다.

1. 구글 시트 열기
2. 우측 상단 **공유** 버튼 클릭
3. 서비스 계정 이메일 입력:
   `your-service-account@project-id.iam.gserviceaccount.com`
   (관리자에게 문의하여 이메일 확인)
4. 권한: **뷰어** (Viewer)
5. **보내기** 클릭

## 3. 대시보드 연동

1. 대시보드 > **데이터 임포트** > **구글 시트** 탭
2. **구글 시트 URL** 입력
3. **범위** 입력 (예: `Sheet1!A1:F`)
   - *주의: 첫 행은 반드시 헤더여야 합니다*
4. **데이터 유형** 선택 (거래/배당/입금)
5. **연결 테스트** 클릭
6. 컬럼 매핑 확인 후 **동기화 시작**

## 문제 해결

**Q. "권한이 없습니다" 오류가 발생해요**
A. 시트가 서비스 계정 이메일로 공유되었는지 확인하세요. 오타가 없는지, 권한이 뷰어 이상인지 확인하세요.

**Q. 데이터를 찾을 수 없다고 나와요**
A. 입력한 범위(Range)가 올바른지 확인하세요. 탭 이름이 포함되어야 합니다 (예: `Sheet1!A1:B10`).

**Q. 날짜 형식이 이상해요**
A. 구글 시트의 날짜 셀 형식을 `텍스트`로 변경하거나, `YYYY-MM-DD` 형식으로 보이도록 설정해주세요.

